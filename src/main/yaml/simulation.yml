incarnation: protelis

variables:
  seed: &seed
    min: 0
    max: 1
    step: 1
    default: 0
  MaxLatitude:
    formula: 44.14795317094557
  MinLatitude: &MinLatitude
    formula: 44.13340676305022
  MaxLongitude:
    formula: 12.267570291912632
  MinLongitude: &MinLongitude
    formula: 12.235568921311268
  LatitudeSpace: &LatitudeSpace
    formula: MaxLatitude - MinLatitude
  LongitudeSpace: &LongitudeSpace
    formula: MaxLongitude - MinLongitude
  DeviceCount: &DeviceCount
    type: ArbitraryVariable
    parameters: [ 100, [ 100, 300, 1000 ] ]
  PoiCount: &PoiCount
    formula: 15

seeds:
  scenario: *seed
  simulation: *seed

network-model:
  type: ConnectWithinDistance
  parameters: [100]

_programs:
  configureNextPoi: &configureNextPoi
    - time-distribution: 1
      type: Event
      actions:
        - type: ConfigureNextPoi
          parameters: [300.0] # max 5 minutes in PoI

  moveToTarget: &moveToTarget
    - time-distribution: 0.5
      type: Event
      actions:
        - type: TargetMapWalker
          parameters: [MovementTarget, 1.4]

deployments:
  # Displace the devices into the map
  - type: Rectangle
    parameters: [*DeviceCount, *MinLatitude, *MinLongitude, *LatitudeSpace, *LongitudeSpace]
    programs:
      - *moveToTarget
      - *configureNextPoi
    contents:
      - molecule: Person
        concentration: true
  - type: Point
    parameters: [44.14895317094557, 12.268570291912632]
    contents:
      - molecule: CloudInstance
        concentration: true
  # Displace the PoIs into the map
  - type: Rectangle
    parameters: [*PoiCount, *MinLatitude, *MinLongitude, *LatitudeSpace, *LongitudeSpace]
    contents:
      - molecule: PoI
        concentration: true

environment:
  type: OSMEnvironment
  parameters: ["cesena.pbf", true, true]

terminate:
  type: AfterTime
  parameters: 1800
